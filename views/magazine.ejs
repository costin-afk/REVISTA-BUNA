<!DOCTYPE html>
<html lang="ro">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title><%= mag.homeTeam %> vs <%= mag.awayTeam %></title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Oswald:wght@400;600;700&family=Source+Sans+3:wght@400;600;700&display=swap" rel="stylesheet">
<style>
:root{
  --h1:<%=mag.homeColor1%>;
  --h2:<%=mag.homeColor2||mag.homeColor1%>;
  --h3:<%=mag.homeColor3||mag.homeColor1%>;
  --a1:<%=mag.awayColor1%>;
  --a2:<%=mag.awayColor2||mag.awayColor1%>;
  --a3:<%=mag.awayColor3||mag.awayColor1%>;
}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
html,body{width:100%;height:100%;overflow:hidden;background:#0d0d0d;font-family:'Source Sans 3',sans-serif;touch-action:none}
.magazine{width:100%;height:100vh;display:flex;will-change:transform}
.page{min-width:100vw;width:100vw;height:100vh;overflow-y:auto;overflow-x:hidden;position:relative;scrollbar-width:none;-webkit-overflow-scrolling:touch}
.page::-webkit-scrollbar{display:none}

/* CLUB LOGO BTN */
.club-logo-btn{position:absolute;top:6px;left:10px;z-index:50;cursor:pointer;display:flex;align-items:center;gap:6px;background:rgba(0,0,0,0.4);border:1px solid rgba(255,255,255,0.12);padding:4px 10px 4px 5px;border-radius:20px;backdrop-filter:blur(6px);transition:background 0.2s}
.club-logo-btn:hover{background:rgba(255,255,255,0.15)}
.club-logo-img{width:28px;height:28px;object-fit:contain;border-radius:50%}
.club-logo-ph{width:28px;height:28px;border-radius:50%;background:var(--h1);display:flex;align-items:center;justify-content:center;font-size:13px}
.club-logo-label{font-size:10px;color:rgba(255,255,255,0.8);letter-spacing:1px;font-weight:600}

/* NAV DOTS + ARROWS at bottom */
.nav-bar{position:fixed;bottom:0;left:0;right:0;display:flex;align-items:center;justify-content:center;gap:10px;z-index:100;background:rgba(0,0,0,0.82);padding:9px 14px 12px;backdrop-filter:blur(12px);border-top:1px solid rgba(255,255,255,0.07)}
.nav-arrow{width:34px;height:34px;border-radius:50%;background:rgba(220,30,30,0.12);border:2px solid #e53935;color:#e53935;font-size:20px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all 0.2s;user-select:none;flex-shrink:0}
.nav-arrow:hover{background:rgba(220,30,30,0.3);color:#fff}
.nav-arrow.hidden{opacity:0;pointer-events:none}
.nav-dots{display:flex;gap:4px;align-items:center}
.dot{width:5px;height:5px;border-radius:50%;background:rgba(255,255,255,0.2);transition:all 0.3s;cursor:pointer}
.dot.active{background:#fff;width:14px;border-radius:3px}
.page-num{position:fixed;top:10px;right:10px;background:rgba(0,0,0,0.6);border:1px solid rgba(255,255,255,0.15);color:rgba(255,255,255,0.6);font-size:10px;letter-spacing:1px;padding:3px 8px;border-radius:8px;z-index:100;backdrop-filter:blur(4px)}

/* COVER */
.cover-page{position:relative;display:flex;flex-direction:column;justify-content:flex-end;min-height:100vh;background:#111}
.cover-photo{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;object-position:center top}
.cover-overlay{position:absolute;inset:0;background:linear-gradient(to bottom,rgba(0,0,0,0.05) 0%,rgba(0,0,0,0.88) 100%)}
.cover-no-photo{position:absolute;inset:0;background:linear-gradient(135deg,var(--h1) 0%,#111 45%,var(--a1) 100%);opacity:0.4}
.cover-club-logo{position:absolute;z-index:5;object-fit:contain}
.cover-club-logo.pos-top-left{top:16px;left:16px}
.cover-club-logo.pos-top-center{top:16px;left:50%;transform:translateX(-50%)}
.cover-club-logo.pos-top-right{top:16px;right:16px}
.cover-club-logo.size-small{width:50px;height:50px}
.cover-club-logo.size-medium{width:80px;height:80px}
.cover-club-logo.size-large{width:110px;height:110px}
.cover-content{position:relative;z-index:2;padding:20px 20px 80px}
.cover-comp{display:inline-block;background:rgba(255,255,255,0.1);border:1px solid rgba(255,255,255,0.2);color:rgba(255,255,255,0.8);font-size:10px;letter-spacing:2px;text-transform:uppercase;padding:3px 10px;border-radius:16px;margin-bottom:10px}
.cover-title{font-family:'Bebas Neue',sans-serif;font-size:clamp(26px,8vw,42px);letter-spacing:3px;line-height:1.1;color:#fff;text-shadow:0 2px 20px rgba(0,0,0,0.9);margin-bottom:6px}
.cover-meta{color:rgba(255,255,255,0.4);font-size:12px}
.color-bar{height:4px;background:linear-gradient(to right,var(--h1) 50%,var(--a1) 50%)}

/* GENERIC PAGE */
.pg{padding:44px 18px 100px}
.pg-label{font-size:10px;letter-spacing:2px;text-transform:uppercase;margin-bottom:3px;opacity:0.5}
.pg-subtitle{font-family:'Oswald',sans-serif;font-size:22px;font-weight:700;letter-spacing:1px;text-transform:uppercase;border-left:4px solid var(--h1);padding-left:10px;margin-bottom:14px}
.pg-body{font-size:15px;line-height:1.85;opacity:0.9;white-space:pre-wrap}

/* TOC */
.toc-page{padding:10px 0 100px;min-height:100vh}
.toc-header{padding:50px 18px 10px}
.toc-title{font-family:'Bebas Neue',sans-serif;font-size:28px;letter-spacing:3px}
.toc-subtitle{font-size:10px;letter-spacing:1px;margin-top:1px;opacity:0.5}
.toc-list{padding:0 10px}
.toc-item{display:flex;align-items:center;border-bottom:1px solid rgba(128,128,128,0.15);cursor:pointer;transition:background 0.15s;border-radius:6px;margin-bottom:2px;overflow:hidden}
.toc-item:hover,.toc-item:active{background:rgba(128,128,128,0.1)}
.toc-num{font-family:'Bebas Neue',sans-serif;font-size:20px;width:40px;text-align:center;padding:8px 0;flex-shrink:0;opacity:0.3}
.toc-text{flex:1;font-size:13px;padding:8px;font-weight:600;opacity:0.8}
.toc-arrow{font-size:14px;padding-right:12px;flex-shrink:0;opacity:0.3}
.toc-item.current .toc-num{color:var(--h1);opacity:1}
.toc-item.current .toc-text{opacity:1}
.toc-item.current{background:rgba(128,128,128,0.08)}

/* PLAYER */
.player-area{display:flex;gap:12px;padding:44px 16px 12px;align-items:flex-start}
.player-photo{width:100px;height:134px;object-fit:cover;object-position:top;border-radius:8px;flex-shrink:0;border:2px solid var(--h1)}
.player-photo-ph{width:100px;height:134px;border-radius:8px;flex-shrink:0;background:linear-gradient(135deg,var(--h1)33,var(--h3)33);border:2px solid var(--h1);display:flex;align-items:center;justify-content:center;font-size:32px}
.player-info{flex:1;padding-top:4px}
.player-name{font-family:'Bebas Neue',sans-serif;font-size:28px;letter-spacing:2px;line-height:1;margin-bottom:8px}
.player-sub{display:inline-block;font-size:13px;font-weight:700;letter-spacing:0.5px;color:#fff;background:linear-gradient(135deg,var(--h1),var(--h3));padding:4px 11px;border-radius:5px;box-shadow:0 3px 10px rgba(0,0,0,0.4);line-height:1.4}
.divider-line{height:1px;background:rgba(128,128,128,0.2);margin:0 16px}

/* STANDINGS */
.standings-page{padding:44px 0 100px}
.standings-title{font-family:'Bebas Neue',sans-serif;font-size:28px;letter-spacing:3px;margin-bottom:12px;padding:0 16px}
.standings-wrap{width:100%;overflow:hidden;background:#fff}
.standings-wrap iframe{display:block;width:100%;border:none;margin-top:-120px}
.standings-ph{border-radius:8px;height:160px;display:flex;align-items:center;justify-content:center;font-size:13px;margin:0 16px;background:rgba(128,128,128,0.1)}

/* ===================== UNIFIED PITCH ===================== */
.formations-page{padding:8px 8px 100px;min-height:100vh}
.form-page-title{font-size:13px;font-weight:700;text-align:center;padding:40px 12px 6px;letter-spacing:1px;opacity:0.8}
.pitch-full{background:#2e8b45;border:2px solid rgba(255,255,255,0.3);border-radius:0;position:relative;margin:0 4px}
.pitch-lines{position:absolute;inset:0;pointer-events:none}
/* center line */
.pitch-center-line{position:absolute;top:50%;left:5%;right:5%;height:1px;background:rgba(255,255,255,0.3)}
/* center circle */
.pitch-center-circle{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:60px;height:60px;border-radius:50%;border:1px solid rgba(255,255,255,0.3)}
/* penalty boxes */
.pitch-box-top{position:absolute;top:0;left:50%;transform:translateX(-50%);width:52%;height:14%;border:1px solid rgba(255,255,255,0.3);border-top:none}
.pitch-box-bot{position:absolute;bottom:0;left:50%;transform:translateX(-50%);width:52%;height:14%;border:1px solid rgba(255,255,255,0.3);border-bottom:none}
/* goal areas */
.pitch-goal-top{position:absolute;top:0;left:50%;transform:translateX(-50%);width:18%;height:4%;border:1px solid rgba(255,255,255,0.3);border-top:none}
.pitch-goal-bot{position:absolute;bottom:0;left:50%;transform:translateX(-50%);width:18%;height:4%;border:1px solid rgba(255,255,255,0.3);border-bottom:none}

.pitch-half{padding:4px 2px;position:relative;z-index:2}
.pitch-row{display:flex;justify-content:space-around;margin-bottom:5px}
.player-token{display:flex;flex-direction:column;align-items:center;gap:1px}
.shirt-wrap{position:relative;width:30px;height:34px}
.shirt-wrap svg{width:100%;height:100%}
.shirt-num{position:absolute;top:50%;left:50%;transform:translate(-50%,-44%);font-size:9px;font-weight:900;line-height:1;text-align:center;pointer-events:none}
.token-name{font-size:8px;text-align:center;max-width:42px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-weight:700;line-height:1.1}

/* Team headers on pitch */
.pitch-team-header{display:flex;align-items:center;gap:6px;padding:4px 8px}
.pitch-team-logo{width:24px;height:24px;object-fit:contain}
.pitch-team-logo-ph{width:24px;height:24px;border-radius:3px;background:rgba(255,255,255,0.2);display:flex;align-items:center;justify-content:center;font-size:10px}
.pitch-team-name{font-family:'Bebas Neue',sans-serif;font-size:16px;letter-spacing:1px;color:#fff;text-shadow:0 1px 3px rgba(0,0,0,0.7);flex:1}
.pitch-team-formation{font-size:9px;color:rgba(255,255,255,0.6);letter-spacing:1px}
.pitch-coach-box{font-size:9px;color:rgba(255,255,255,0.7);padding:0 8px 3px;font-style:italic}
.coach-outside{font-size:11px;font-style:italic;padding:3px 8px;opacity:0.75;letter-spacing:0.3px}
.pitch-divider{height:1px;background:rgba(255,255,255,0.3);margin:2px 6px}

/* Notification btn */
.notify-btn{width:calc(100% - 16px);margin:8px 8px 0;padding:10px;background:rgba(0,0,0,0.3);border:1px solid rgba(255,255,255,0.15);border-radius:8px;color:rgba(255,255,255,0.7);font-size:12px;font-weight:600;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:7px;transition:all 0.2s;font-family:'Source Sans 3',sans-serif}
.notify-btn:hover{border-color:rgba(255,255,255,0.4);color:#fff}
.notify-btn.active{background:rgba(0,230,118,0.1);border-color:#00e676;color:#00e676}

/* RESERVES */
.reserves-page{min-height:100vh;display:flex;flex-direction:column}
.reserves-hdr{padding:44px 16px 10px}
.reserves-hdr-title{font-family:'Bebas Neue',sans-serif;font-size:28px;letter-spacing:3px}
.reserves-body{display:flex;flex:1}
.res-col{flex:1;padding:12px 10px 100px}
.res-col.home-col{border-right:2px solid var(--h1)}
.res-col-title{font-family:'Oswald',sans-serif;font-size:12px;font-weight:700;letter-spacing:1px;text-transform:uppercase;padding-bottom:7px;margin-bottom:8px}
.res-text{font-size:13px;line-height:2;white-space:pre-wrap;opacity:0.85}

/* H2H */
.h2h-page{padding:44px 16px 100px}
.h2h-title{font-family:'Bebas Neue',sans-serif;font-size:26px;letter-spacing:2px;margin-bottom:16px}
.h2h-rows{display:flex;flex-direction:column;margin-bottom:18px;border-radius:8px;overflow:hidden;border:1px solid rgba(128,128,128,0.2)}
.h2h-row{display:flex;align-items:center;padding:13px 14px;border-bottom:1px solid rgba(128,128,128,0.15)}
.h2h-row:last-child{border-bottom:none;background:rgba(128,128,128,0.05)}
.h2h-label{flex:1;font-size:15px;font-weight:600;opacity:0.9}
.h2h-value{font-family:'Bebas Neue',sans-serif;font-size:28px;min-width:44px;text-align:right}
.h2h-label.home-label{color:var(--h1);filter:brightness(1.2);opacity:1}
.h2h-label.away-label{color:var(--a1);filter:brightness(1.2);opacity:1}
.h2h-video{width:100%;aspect-ratio:16/9;border-radius:8px;overflow:hidden;background:#111}
.h2h-video iframe{width:100%;height:100%;border:none}

/* COACHES */
.coaches-page{padding:44px 16px 100px}
.coaches-title{font-family:'Bebas Neue',sans-serif;font-size:28px;letter-spacing:2px;margin-bottom:16px}
.coaches-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:16px}
.coach-card{border:1px solid rgba(128,128,128,0.2);border-radius:10px;overflow:hidden;display:flex;flex-direction:column;align-items:center;padding:14px 10px 12px;background:rgba(128,128,128,0.06)}
.coach-photo{width:80px;height:100px;object-fit:cover;object-position:top;border-radius:7px;border:2px solid var(--h1);margin-bottom:8px}
.coach-photo.away{border-color:var(--a1)}
.coach-photo-ph{width:80px;height:100px;border-radius:7px;border:2px solid var(--h1);display:flex;align-items:center;justify-content:center;font-size:28px;margin-bottom:8px;background:rgba(128,128,128,0.1)}
.coach-photo-ph.away{border-color:var(--a1)}
.coach-name{font-family:'Oswald',sans-serif;font-size:14px;font-weight:700;text-align:center;letter-spacing:0.5px;margin-bottom:4px}
.coach-team-lbl{font-size:10px;text-align:center;letter-spacing:1px;text-transform:uppercase;opacity:0.6}
.coaches-texts{display:grid;grid-template-columns:1fr 1fr;gap:12px}
.coach-text-block{border:1px solid rgba(128,128,128,0.2);border-radius:8px;padding:12px;background:rgba(128,128,128,0.04)}
.coach-text-label{font-size:10px;letter-spacing:1px;text-transform:uppercase;margin-bottom:6px;opacity:0.6}
.coach-text{font-size:14px;line-height:1.7;opacity:0.85;white-space:pre-wrap}

/* PALMARES */
.palmares-page{padding:44px 14px 100px}
.palmares-title{font-family:'Bebas Neue',sans-serif;font-size:28px;letter-spacing:3px;margin-bottom:12px}
.palmares-photo{float:left;width:40%;max-height:64vh;object-fit:cover;object-position:top;border-radius:8px;margin-right:12px;margin-bottom:6px;border:2px solid var(--h1)}
.palmares-photo-ph{float:left;width:40%;height:40vh;border-radius:8px;margin-right:12px;margin-bottom:6px;border:2px dashed rgba(128,128,128,0.3);display:flex;align-items:center;justify-content:center;font-size:28px}
.palmares-text{font-size:15px;line-height:1.85;opacity:0.85;white-space:pre-wrap}
.palmares-clear{clear:both}

/* AD */
.ad-page{padding:44px 14px 100px;display:flex;flex-direction:column;min-height:100vh}
.ad-title-txt{font-family:'Bebas Neue',sans-serif;font-size:24px;letter-spacing:2px;margin-bottom:14px}
.ad-content{flex:1;display:flex;align-items:center;justify-content:center}
.ad-ph{border:1px dashed rgba(128,128,128,0.3);border-radius:8px;height:140px;display:flex;align-items:center;justify-content:center;font-size:13px;width:100%;opacity:0.5}

/* VOTE */
.vote-page{padding:44px 14px 100px}
.vote-title{font-family:'Bebas Neue',sans-serif;font-size:30px;letter-spacing:2px;margin-bottom:2px}
.vote-sub{font-size:11px;margin-bottom:14px;opacity:0.6}
.vote-closed-banner{background:linear-gradient(135deg,var(--h1),var(--h3));border-radius:10px;padding:14px;text-align:center;margin-bottom:14px}
.vote-closed-banner p{color:#fff;font-size:13px;font-weight:600}
.vote-cands{display:flex;flex-direction:column;gap:8px}
.vote-card{border:2px solid rgba(128,128,128,0.2);border-radius:10px;padding:13px 14px;cursor:pointer;transition:all 0.2s;display:flex;flex-direction:column;gap:6px;position:relative;background:rgba(128,128,128,0.05)}
.vote-card:hover:not(.stopped){border-color:rgba(128,128,128,0.4)}
.vote-card.voted{border-color:#00e676;background:rgba(0,230,118,0.06)}
.vote-card.mvp-card{border-color:gold;background:rgba(255,215,0,0.08)}
.mvp-badge{position:absolute;top:-10px;right:12px;background:gold;color:#000;font-family:'Bebas Neue',sans-serif;font-size:14px;letter-spacing:2px;padding:2px 10px;border-radius:10px}
.vc-top{display:flex;align-items:center;justify-content:space-between}
.vc-name{font-family:'Oswald',sans-serif;font-size:18px;font-weight:700;letter-spacing:1px}
.vc-check{width:22px;height:22px;border-radius:50%;border:2px solid rgba(128,128,128,0.4);display:flex;align-items:center;justify-content:center;font-size:11px;transition:all 0.2s;flex-shrink:0}
.vote-card.voted .vc-check{background:#00e676;border-color:#00e676;color:#000}
.vc-bar-wrap{background:rgba(255,255,255,0.08);border-radius:3px;height:5px;overflow:hidden}
.vc-bar{height:100%;border-radius:3px;background:#00e676;transition:width 0.5s ease;width:0%}
.vc-bar.mvp-bar{background:gold}
.vc-stats{display:flex;justify-content:space-between;align-items:center}
.vc-pct{font-size:16px;font-weight:700;color:#00e676}
.vc-cnt{font-size:10px;opacity:0.5}
.vote-total{text-align:center;font-size:11px;margin-top:10px;opacity:0.5}
.vote-notify-btn{width:100%;margin-top:14px;padding:11px;border:1px solid rgba(128,128,128,0.25);border-radius:8px;font-size:13px;font-weight:600;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:8px;transition:all 0.2s;background:rgba(128,128,128,0.05);font-family:'Source Sans 3',sans-serif}
.vote-notify-btn:hover{border-color:rgba(128,128,128,0.5)}
.vote-notify-btn.active{background:rgba(0,230,118,0.08);border-color:#00e676;color:#00e676}

/* PROMO */
.promo-page{padding:44px 14px 100px;min-height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center}
.promo-ph{border:1px dashed rgba(128,128,128,0.3);border-radius:8px;height:160px;display:flex;align-items:center;justify-content:center;font-size:13px;width:100%;opacity:0.5}

/* PROGRAM */
.program-page{padding:44px 0 0}
.prog-photo{width:100%;height:33vh;object-fit:cover;display:block}
.prog-photo-ph{width:100%;height:33vh;display:flex;align-items:center;justify-content:center;font-size:13px;opacity:0.4}
.prog-content{padding:16px 16px 100px}
.prog-title{font-family:'Bebas Neue',sans-serif;font-size:26px;letter-spacing:3px;margin-bottom:10px}
.prog-text{font-size:15px;line-height:1.8;opacity:0.85;white-space:pre-wrap}
</style>
</head>
<body>
<%
const pageBg = mag.pageBg || [];
const pageFg = mag.pageFg || [];
function pbg(i){ return pageBg[i-1] || '#0d0d0d'; }
function pfg(i){ return pageFg[i-1] || '#ffffff'; }

const FORMATIONS={
  '4-3-3':[[1],[4,3,2,5],[8,6,10],[9,7,11]],
  '4-4-2':[[1],[2,3,4,5],[6,7,8,9],[10,11]],
  '4-2-3-1':[[1],[2,3,4,5],[6,8],[7,10,11],[9]],
  '3-4-3':[[1],[2,5,3],[4,6,8,7],[9,10,11]],
  '4-1-4-1':[[1],[2,3,4,5],[6],[7,8,9,10],[11]],
  '5-4-1':[[1],[2,3,5,4,6],[7,8,9,10],[11]],
  '5-3-2':[[1],[2,3,5,4,6],[7,8,9],[10,11]]
};
function getRows(k){return FORMATIONS[k]||FORMATIONS['4-3-3'];}

function shirtSVG(shirt, collar, numCol, num){
  return `<div class="shirt-wrap">
    <svg viewBox="0 0 50 55" xmlns="http://www.w3.org/2000/svg">
      <path d="M5,14 L0,28 L13,30 L13,54 L37,54 L37,30 L50,28 L45,14 L36,10 C34,16 16,16 14,10 Z" fill="${shirt}" stroke="rgba(0,0,0,0.2)" stroke-width="1.2"/>
      <path d="M14,10 C16,16 34,16 36,10 L38,6 C34,2 30,0 25,0 C20,0 16,2 12,6 Z" fill="${collar}" stroke="rgba(0,0,0,0.2)" stroke-width="1.2"/>
    </svg>
    <div class="shirt-num" style="color:${numCol}">${num}</div>
  </div>`;
}

const tocDefs=['Cuprins','Avancronica','JucƒÉtor Cheie','Clasament','Forma»õii de Start','Rezerve','Head to Head','Ce spun antrenorii','Palmares','ReclamƒÉ','JucƒÉtorul Meciului','Promo','Program'];
const tocItems=mag.tocItems&&mag.tocItems.length===13?mag.tocItems:tocDefs;
const tocPages=[2,[3,4],[5,6],7,8,9,10,11,12,13,14,15,16];

function clubBtn(pg){
  const fg=pfg(pg);
  if(mag.clubLogo){
    return `<div class="club-logo-btn" onclick="goToPage(2)"><img src="${mag.clubLogo}" class="club-logo-img"><span class="club-logo-label" style="color:${fg}88">CUPRINS</span></div>`;
  }
  return `<div class="club-logo-btn" onclick="goToPage(2)"><div class="club-logo-ph">üè†</div><span class="club-logo-label" style="color:${fg}88">CUPRINS</span></div>`;
}
%>

<div class="magazine" id="magazine">

<!-- P1 COVER -->
<div class="page" data-page="1" style="background:<%=pbg(1)%>;color:<%=pfg(1)%>">
  <div class="cover-page">
    <%if(mag.cover){%><img src="<%=mag.cover%>" class="cover-photo"><div class="cover-overlay"></div><%}else{%><div class="cover-no-photo"></div><div class="cover-overlay"></div><%}%>
    <div class="color-bar" style="position:absolute;top:0;left:0;right:0;z-index:3"></div>
    <%if(mag.clubLogo){%><img src="<%=mag.clubLogo%>" class="cover-club-logo pos-<%=mag.logoPosition||'top-left'%> size-<%=mag.logoSize||'medium'%>"><%}%>
    <div class="cover-content">
      <div class="cover-comp">üèÜ <%=mag.competition%> ¬∑ <%=mag.matchDate%></div>
      <div class="cover-title"><%=mag.coverTitle||mag.homeTeam+' vs '+mag.awayTeam%></div>
      <div class="cover-meta">üèüÔ∏è <%=mag.stadium%></div>
    </div>
    <div class="color-bar"></div>
  </div>
</div>

<!-- P2 TOC -->
<div class="page" data-page="2" style="background:<%=pbg(2)%>;color:<%=pfg(2)%>">
  <%- clubBtn(2) %>
  <div class="toc-page">
    <div class="toc-header"><div class="toc-title">üè† CUPRINS</div><div class="toc-subtitle">ApasƒÉ pentru a naviga direct</div></div>
    <div class="toc-list">
      <% tocItems.forEach(function(item,i){ const pg=tocPages[i]; const fp=Array.isArray(pg)?pg[0]:pg; const lp=Array.isArray(pg)?pg[pg.length-1]:pg; %>
      <div class="toc-item" id="toc-<%=i%>" onclick="goToPage(<%=fp%>)" style="color:<%=pfg(2)%>">
        <div class="toc-num" style="color:<%=pfg(2)%>"><%=fp%><%=lp!==fp?'-'+lp:''%></div>
        <div class="toc-text"><%=item%></div>
        <div class="toc-arrow">‚Ä∫</div>
      </div>
      <% }) %>
    </div>
  </div>
</div>

<!-- P3 -->
<div class="page" data-page="3" style="background:<%=pbg(3)%>;color:<%=pfg(3)%>">
  <%- clubBtn(3) %>
  <div class="pg">
    <div class="pg-label">Pagina 3</div>
    <div class="pg-subtitle" style="color:<%=pfg(3)%>"><%=mag.avancronicaTitle||'Avancronica'%></div>
    <div class="pg-body"><%=mag.avancronicaP1||'Con»õinut √Æn cur√¢nd...'%></div>
  </div>
</div>

<!-- P4 -->
<div class="page" data-page="4" style="background:<%=pbg(4)%>;color:<%=pfg(4)%>">
  <%- clubBtn(4) %>
  <div class="pg">
    <div class="pg-label">Pagina 4</div>
    <div class="pg-subtitle" style="color:<%=pfg(4)%>"><%=mag.avancronicaTitle||'Avancronica'%> (cont.)</div>
    <div class="pg-body"><%=mag.avancronicaP2||''%></div>
  </div>
</div>

<!-- P5 -->
<div class="page" data-page="5" style="background:<%=pbg(5)%>;color:<%=pfg(5)%>">
  <%- clubBtn(5) %>
  <div class="player-area">
    <%if(mag.playerPhoto){%><img src="<%=mag.playerPhoto%>" class="player-photo"><%}else{%><div class="player-photo-ph">‚≠ê</div><%}%>
    <div class="player-info">
      <div class="player-name"><%=mag.playerTitle||'JucƒÉtorul Meciului'%></div>
      <%if(mag.playerSubtitle){%><div class="player-sub"><%=mag.playerSubtitle%></div><%}%>
    </div>
  </div>
  <div class="divider-line"></div>
  <div class="pg" style="padding-top:12px"><div class="pg-body"><%=mag.playerText||''%></div></div>
</div>

<!-- P6 -->
<div class="page" data-page="6" style="background:<%=pbg(6)%>;color:<%=pfg(6)%>">
  <%- clubBtn(6) %>
  <div class="pg">
    <div class="pg-label">Pagina 6</div>
    <div class="pg-subtitle" style="border-left-color:var(--a1);color:<%=pfg(6)%>"><%=mag.playerTitle||'Profil'%></div>
    <div class="pg-body"><%=mag.playerText||''%></div>
  </div>
</div>

<!-- P7 STANDINGS -->
<div class="page" data-page="7" style="background:<%=pbg(7)%>;color:<%=pfg(7)%>">
  <%- clubBtn(7) %>
  <div class="standings-page">
    <div class="standings-title"><%=mag.standingsTitle||'Clasament'%></div>
    <%if(mag.standingsEmbed){%><div class="standings-wrap"><%- mag.standingsEmbed %></div><%}else{%><div class="standings-ph">üìä AdaugƒÉ embed clasament</div><%}%>
  </div>
</div>

<!-- P8 UNIFIED FORMATIONS -->
<div class="page" data-page="8" style="background:<%=pbg(8)%>;color:<%=pfg(8)%>">
  <%- clubBtn(8) %>
  <div class="formations-page">
    <div class="form-page-title" style="color:<%=pfg(8)%>"><%=mag.formationTitle||'Forma»õii probabile'%></div>
    <%
    const hSC=mag.homeShirtColor||'#e63946';
    const hCC=mag.homeCollarColor||'#1d3557';
    const hNC=mag.homeNumColor||'#ffffff';
    const hNmC=mag.homeNameColor||'#ffffff';
    const aSC=mag.awayShirtColor||'#457b9d';
    const aCC=mag.awayCollarColor||'#ffffff';
    const aNC=mag.awayNumColor||'#ffffff';
    const aNmC=mag.awayNameColor||'#ffffff';
    const hRows=getRows(mag.homeFormation);
    const aRows=getRows(mag.awayFormation);
    // Home: GK first (top), then defenders, mids, forwards toward center
    const hRev=[...hRows]; // normal order: GK first = displayed first = top of pitch
    // Away: attackers at top (near center), GK at bottom
    const aFwd=[...aRows].reverse(); // reversed: attackers first displayed = near center
    %>
    <%if(mag.homeCoachFormation){%><div class="coach-outside" style="color:<%=pfg(8)%>">üéΩ Antrenor: <%=mag.homeCoachFormation%></div><%}%>
    <div class="pitch-full">
      <!-- Pitch lines overlay -->
      <div class="pitch-lines">
        <div class="pitch-center-line"></div>
        <div class="pitch-center-circle"></div>
        <div class="pitch-box-top"></div>
        <div class="pitch-box-bot"></div>
        <div class="pitch-goal-top"></div>
        <div class="pitch-goal-bot"></div>
      </div>

      <!-- HOME TEAM (top half) -->
      <div class="pitch-team-header">
        <%if(mag.homeLogoPhoto){%><img src="<%=mag.homeLogoPhoto%>" class="pitch-team-logo"><%}else{%><div class="pitch-team-logo-ph">üî¥</div><%}%>
        <div class="pitch-team-name"><%=mag.homeFormationTitle||mag.homeTeam%></div>
        <div class="pitch-team-formation"><%=mag.homeFormation%></div>
      </div>
      <div class="pitch-half">
        <% let hi=0; hRev.forEach(function(row, ri){ %>
        <div class="pitch-row">
          <% row.forEach(function(s){
            const num=(mag.homePlayerNumbers&&mag.homePlayerNumbers[hi])?mag.homePlayerNumbers[hi]:s;
            const name=(mag.homePlayerNames&&mag.homePlayerNames[hi])?mag.homePlayerNames[hi]:'';
            const isGK=(ri===0);
            const sc=isGK?'#f9e79f':hSC; const cc=isGK?'#c8a000':hCC; const nc=isGK?'#333':hNC;
            hi++;
          %>
          <div class="player-token">
            <%- shirtSVG(sc, cc, nc, num) %>
            <div class="token-name" style="color:<%=hNmC%>"><%=name%></div>
          </div>
          <% }) %>
        </div>
        <% }) %>
      </div>

      <div class="pitch-divider"></div>

      <!-- AWAY TEAM (bottom half) -->
      <div class="pitch-half">
        <% // Away indices run in reverse: attackers (high index) shown first, GK (index 0) shown last
        const awayTotal=aFwd.reduce((s,r)=>s+r.length,0);
        let ai=awayTotal-1; aFwd.forEach(function(row, ri){ %>
        <div class="pitch-row">
          <% row.forEach(function(s){
            const num=(mag.awayPlayerNumbers&&mag.awayPlayerNumbers[ai])?mag.awayPlayerNumbers[ai]:s;
            const name=(mag.awayPlayerNames&&mag.awayPlayerNames[ai])?mag.awayPlayerNames[ai]:'';
            const isGK=(ri===aFwd.length-1);
            const sc=isGK?'#aed6f1':aSC; const cc=isGK?'#27ae60':aCC; const nc=isGK?'#333':aNC;
            ai--;
          %>
          <div class="player-token">
            <%- shirtSVG(sc, cc, nc, num) %>
            <div class="token-name" style="color:<%=aNmC%>"><%=name%></div>
          </div>
          <% }) %>
        </div>
        <% }) %>
      </div>
      <div class="pitch-team-header">
        <%if(mag.awayLogoPhoto){%><img src="<%=mag.awayLogoPhoto%>" class="pitch-team-logo"><%}else{%><div class="pitch-team-logo-ph">üü¢</div><%}%>
        <div class="pitch-team-name"><%=mag.awayFormationTitle||mag.awayTeam%></div>
        <div class="pitch-team-formation"><%=mag.awayFormation%></div>
      </div>
    </div>
    <%if(mag.awayCoachFormation){%><div class="coach-outside" style="color:<%=pfg(8)%>">üéΩ Antrenor: <%=mag.awayCoachFormation%></div><%}%>
    <button class="notify-btn" id="formNotifyBtn" onclick="toggleFormNotify()">üîî ActiveazƒÉ notificare forma»õii de start</button>
  </div>
</div>

<!-- P9 RESERVES -->
<div class="page" data-page="9" style="background:<%=pbg(9)%>;color:<%=pfg(9)%>">
  <%- clubBtn(9) %>
  <div class="reserves-page">
    <div class="reserves-hdr"><div class="reserves-hdr-title">REZERVE</div></div>
    <div class="reserves-body">
      <div class="res-col home-col">
        <div class="res-col-title" style="color:var(--h1);border-bottom:2px solid var(--h1)"><%=mag.homeTeam%></div>
        <div class="res-text"><%=mag.homeReserves||'‚Äì'%></div>
      </div>
      <div class="res-col away-col">
        <div class="res-col-title" style="color:var(--a1);border-bottom:2px solid var(--a1)"><%=mag.awayTeam%></div>
        <div class="res-text"><%=mag.awayReserves||'‚Äì'%></div>
      </div>
    </div>
  </div>
</div>

<!-- P10 H2H -->
<div class="page" data-page="10" style="background:<%=pbg(10)%>;color:<%=pfg(10)%>">
  <%- clubBtn(10) %>
  <div class="h2h-page">
    <div class="h2h-title"><%=mag.h2hTitle||'√ént√¢lniri directe'%></div>
    <%if(mag.h2hLabels&&mag.h2hLabels.length){%>
    <div class="h2h-rows">
      <%mag.h2hLabels.forEach(function(lbl,i){
        const val=mag.h2hValues&&mag.h2hValues[i]?mag.h2hValues[i]:'';
        const hw=mag.homeTeam.toLowerCase().split(' ')[0];
        const aw=mag.awayTeam.toLowerCase().split(' ')[0];
        const isHome=lbl.toLowerCase().includes(hw);
        const isAway=!isHome&&lbl.toLowerCase().includes(aw);
      %>
      <div class="h2h-row" style="background:rgba(128,128,128,0.05)">
        <div class="h2h-label <%=isHome?'home-label':isAway?'away-label':''%>"><%=lbl%></div>
        <div class="h2h-value"><%=val%></div>
      </div>
      <%})%>
    </div>
    <%}%>
    <%if(mag.h2hYoutubeEmbed){%><div class="h2h-video"><%- mag.h2hYoutubeEmbed %></div><%}%>
  </div>
</div>

<!-- P11 COACHES -->
<div class="page" data-page="11" style="background:<%=pbg(11)%>;color:<%=pfg(11)%>">
  <%- clubBtn(11) %>
  <div class="coaches-page">
    <div class="coaches-title"><%=mag.coachesTitle||'Ce spun antrenorii'%></div>
    <div class="coaches-grid">
      <div class="coach-card">
        <%if(mag.homeCoachPhoto){%><img src="<%=mag.homeCoachPhoto%>" class="coach-photo"><%}else{%><div class="coach-photo-ph">üë®‚Äçüíº</div><%}%>
        <div class="coach-name"><%=mag.homeCoachName||'Antrenor Gazde'%></div>
        <div class="coach-team-lbl" style="color:var(--h1);opacity:1"><%=mag.homeTeam%></div>
      </div>
      <div class="coach-card">
        <%if(mag.awayCoachPhoto){%><img src="<%=mag.awayCoachPhoto%>" class="coach-photo away"><%}else{%><div class="coach-photo-ph away">üë®‚Äçüíº</div><%}%>
        <div class="coach-name"><%=mag.awayCoachName||'Antrenor Oaspete'%></div>
        <div class="coach-team-lbl" style="color:var(--a1);opacity:1"><%=mag.awayTeam%></div>
      </div>
    </div>
    <div class="coaches-texts">
      <div class="coach-text-block">
        <div class="coach-text-label" style="color:var(--h1);opacity:1"><%=mag.homeCoachName||mag.homeTeam%></div>
        <div class="coach-text"><%=mag.homeCoachText||''%></div>
      </div>
      <div class="coach-text-block">
        <div class="coach-text-label" style="color:var(--a1);opacity:1"><%=mag.awayCoachName||mag.awayTeam%></div>
        <div class="coach-text"><%=mag.awayCoachText||''%></div>
      </div>
    </div>
  </div>
</div>

<!-- P12 PALMARES -->
<div class="page" data-page="12" style="background:<%=pbg(12)%>;color:<%=pfg(12)%>">
  <%- clubBtn(12) %>
  <div class="palmares-page">
    <div class="palmares-title"><%=mag.palmaresTitle||'Palmares'%></div>
    <div>
      <%if(mag.palmaresPhoto){%><img src="<%=mag.palmaresPhoto%>" class="palmares-photo"><%}else{%><div class="palmares-photo-ph">üèÜ</div><%}%>
      <div class="palmares-text"><%=mag.palmaresText||''%></div>
      <div class="palmares-clear"></div>
    </div>
  </div>
</div>

<!-- P13 AD -->
<div class="page" data-page="13" style="background:<%=pbg(13)%>;color:<%=pfg(13)%>">
  <%- clubBtn(13) %>
  <div class="ad-page">
    <%if(mag.adTitle){%><div class="ad-title-txt"><%=mag.adTitle%></div><%}%>
    <div class="ad-content"><%if(mag.adEmbed){%><%- mag.adEmbed %><%}else{%><div class="ad-ph">üì¢ Spa»õiu publicitar</div><%}%></div>
  </div>
</div>

<!-- P14 VOTE -->
<div class="page" data-page="14" style="background:<%=pbg(14)%>;color:<%=pfg(14)%>">
  <%- clubBtn(14) %>
  <div class="vote-page">
    <div class="vote-title">üèÖ JUCƒÇTORUL MECIULUI</div>
    <div class="vote-sub" id="voteSubtitle"><%=mag.voteStopped?'Votul s-a √Æncheiat':'VoteazƒÉ favoritul tƒÉu ¬∑ Un vot per dispozitiv'%></div>
    <%if(mag.voteStopped){%><div class="vote-closed-banner"><p>üèÜ Votul s-a √Æncheiat! MVP: <strong><%=mag.mvp||'‚Äì'%></strong></p></div><%}%>
    <%const cands=[mag.voteCandidate0,mag.voteCandidate1,mag.voteCandidate2];%>
    <%if(cands.some(c=>c&&c.trim())){%>
    <div class="vote-cands" id="voteCands">
      <%cands.forEach(function(name,i){if(name&&name.trim()){%>
      <div class="vote-card <%=mag.voteStopped?'stopped':''%> <%=mag.voteStopped&&mag.mvp===name?'mvp-card':''%>" id="vc<%=i%>" onclick="castVote(<%=i%>)">
        <%if(mag.voteStopped&&mag.mvp===name){%><div class="mvp-badge">MVP üèÜ</div><%}%>
        <div class="vc-top"><div class="vc-name" style="color:<%=pfg(14)%>"><%=name%></div><div class="vc-check" id="chk<%=i%>">‚úì</div></div>
        <div class="vc-bar-wrap"><div class="vc-bar <%=mag.voteStopped&&mag.mvp===name?'mvp-bar':''%>" id="bar<%=i%>"></div></div>
        <div class="vc-stats"><div class="vc-pct" id="pct<%=i%>">0%</div><div class="vc-cnt" id="cnt<%=i%>">0 voturi</div></div>
      </div>
      <%}})%>
    </div>
    <div class="vote-total" id="vTotal">0 voturi totale</div>
    <button class="vote-notify-btn" id="voteNotifyBtn" onclick="toggleVoteNotify()" style="color:<%=pfg(14)%>">üîî NotificƒÉ-mƒÉ c√¢nd se deschide votul</button>
    <%}else{%><div style="text-align:center;padding:40px;font-size:14px;opacity:0.5">Candida»õii vor fi anun»õa»õi √Æn cur√¢nd</div><%}%>
  </div>
</div>

<!-- P15 PROMO -->
<div class="page" data-page="15" style="background:<%=pbg(15)%>;color:<%=pfg(15)%>">
  <%- clubBtn(15) %>
  <div class="promo-page">
    <%if(mag.promoEmbed){%><div style="width:100%"><%- mag.promoEmbed %></div><%}else{%><div class="promo-ph">üì£ Spa»õiu banner publicitar</div><%}%>
  </div>
</div>

<!-- P16 PROGRAM -->
<div class="page" data-page="16" style="background:<%=pbg(16)%>;color:<%=pfg(16)%>">
  <%- clubBtn(16) %>
  <div class="program-page">
    <%if(mag.stadiumPhoto){%><img src="<%=mag.stadiumPhoto%>" class="prog-photo"><%}else{%><div class="prog-photo-ph">üèüÔ∏è</div><%}%>
    <div class="prog-content">
      <div class="prog-title"><%=mag.programTitle||'Programul echipei noastre'%></div>
      <div class="prog-text"><%=mag.programText||''%></div>
    </div>
  </div>
</div>

</div><!-- end magazine -->

<!-- BOTTOM NAV BAR -->
<div class="nav-bar" id="navBar">
  <button class="nav-arrow hidden" id="arrowLeft" onclick="nav(-1)">‚Äπ</button>
  <div class="nav-dots" id="navDots"><%for(let i=1;i<=16;i++){%><div class="dot <%=i===1?'active':''%>" onclick="goToPage(<%=i%>)"></div><%}%></div>
  <button class="nav-arrow hidden" id="arrowRight" onclick="nav(1)">‚Ä∫</button>
</div>
<div class="page-num" id="pageNum">1 / 16</div>

<script>
const MAG_ID='<%=mag.id%>';
const TOTAL=16;
let cur=1,sx=0,sy=0,drag=false;
let myVote=localStorage.getItem('v_'+MAG_ID);
myVote=myVote!==null?parseInt(myVote):null;
let voteNotifyOn=localStorage.getItem('vnotify_'+MAG_ID)==='1';
let formNotifyOn=localStorage.getItem('fnotify_'+MAG_ID)==='1';
const mag=document.getElementById('magazine');

function playRustle(){}

mag.addEventListener('touchstart',e=>{sx=e.touches[0].clientX;sy=e.touches[0].clientY;drag=true},{passive:true});
mag.addEventListener('touchend',e=>{
  if(!drag)return;
  const dx=e.changedTouches[0].clientX-sx,dy=e.changedTouches[0].clientY-sy;
  if(Math.abs(dx)>Math.abs(dy)&&Math.abs(dx)>40){playRustle();if(dx<0)nav(1);else nav(-1);}
  drag=false;
},{passive:true});
let msx=0;
mag.addEventListener('mousedown',e=>msx=e.clientX);
mag.addEventListener('mouseup',e=>{const dx=e.clientX-msx;if(Math.abs(dx)>50){playRustle();if(dx<0)nav(1);else nav(-1);}});

function nav(d){const n=cur+d;if(n>=1&&n<=TOTAL)goToPage(n);}

function goToPage(n){
  cur=n;
  mag.style.transition='transform 0.32s cubic-bezier(0.25,0.46,0.45,0.94)';
  mag.style.transform=`translateX(-${(n-1)*100}vw)`;
  setTimeout(()=>mag.style.transition='none',320);
  document.querySelectorAll('.dot').forEach((d,i)=>d.classList.toggle('active',i===n-1));
  document.getElementById('pageNum').textContent=`${n} / ${TOTAL}`;
  document.getElementById('arrowLeft').classList.toggle('hidden',n===1);
  document.getElementById('arrowRight').classList.toggle('hidden',n===TOTAL);
  const tocMap={2:0,3:1,4:1,5:2,6:2,7:3,8:4,9:5,10:6,11:7,12:8,13:9,14:10,15:11,16:12};
  document.querySelectorAll('.toc-item').forEach(el=>el.classList.remove('current'));
  if(tocMap[n]!==undefined){const el=document.getElementById('toc-'+tocMap[n]);if(el)el.classList.add('current');}
  if(n===14)loadVotes();
}

// Update arrow visibility on start
document.getElementById('arrowRight').classList.remove('hidden');

// VOTE
function castVote(ci){
  fetch(`/api/votes/${MAG_ID}`).then(r=>r.json()).then(d=>{
    if(d.voteStopped)return;
    if(myVote===ci)return;
    const prev=myVote; myVote=ci; localStorage.setItem('v_'+MAG_ID,ci);
    fetch(`/api/vote/${MAG_ID}`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({candidate:ci,previousCandidate:prev})})
      .then(r=>r.json()).then(d=>renderVotes(d.votes,d.voteStopped,d.mvp));
  });
}
function loadVotes(){fetch(`/api/votes/${MAG_ID}`).then(r=>r.json()).then(d=>renderVotes(d.votes,d.voteStopped,d.mvp));}
function renderVotes(votes,stopped,mvp){
  if(!votes)return;
  const total=Object.values(votes).reduce((a,b)=>a+b,0);
  const el=document.getElementById('vTotal');if(el)el.textContent=`${total} vot${total!==1?'uri':''} totale`;
  const sub=document.getElementById('voteSubtitle');if(sub)sub.textContent=stopped?'Votul s-a √Æncheiat':'VoteazƒÉ favoritul tƒÉu ¬∑ Un vot per dispozitiv';
  const cands=['<%=mag.voteCandidate0%>','<%=mag.voteCandidate1%>','<%=mag.voteCandidate2%>'];
  [0,1,2].forEach(i=>{
    const card=document.getElementById('vc'+i);if(!card)return;
    const v=votes[i]||0,pct=total>0?Math.round(v/total*100):0;
    document.getElementById('bar'+i).style.width=pct+'%';
    document.getElementById('pct'+i).textContent=pct+'%';
    document.getElementById('cnt'+i).textContent=v+' vot'+(v!==1?'uri':'');
    card.classList.toggle('voted',!stopped&&myVote===i);
    card.classList.toggle('stopped',!!stopped);
    const isMVP=stopped&&mvp&&mvp===cands[i];
    card.classList.toggle('mvp-card',!!isMVP);
    const bar=document.getElementById('bar'+i);if(bar)bar.className='vc-bar'+(isMVP?' mvp-bar':'');
    let badge=card.querySelector('.mvp-badge');
    if(isMVP&&!badge){badge=document.createElement('div');badge.className='mvp-badge';badge.textContent='MVP üèÜ';card.insertBefore(badge,card.firstChild);}
    else if(!isMVP&&badge)badge.remove();
  });
}
if(document.getElementById('vc0'))loadVotes();

// NOTIFICATIONS
function requestAndSetNotify(key, btnId, onLabel, offLabel, onCallback){
  if(!('Notification' in window)){alert('Browserul tƒÉu nu suportƒÉ notificƒÉri.');return;}
  const current=localStorage.getItem(key)==='1';
  if(current){
    localStorage.setItem(key,'0');
    const btn=document.getElementById(btnId);if(btn){btn.textContent=offLabel;btn.classList.remove('active');}
    return;
  }
  Notification.requestPermission().then(p=>{
    if(p==='granted'){
      localStorage.setItem(key,'1');
      const btn=document.getElementById(btnId);if(btn){btn.textContent=onLabel;btn.classList.add('active');}
      new Notification('MatchMag üèÜ',{body:'Notificare activatƒÉ!',icon:'/favicon.ico'});
      if(onCallback)onCallback();
    } else { alert('Permisiunea pentru notificƒÉri a fost refuzatƒÉ.'); }
  });
}

function toggleVoteNotify(){
  requestAndSetNotify('vnotify_'+MAG_ID,'voteNotifyBtn','üîî Notificare activatƒÉ ‚úì','üîî NotificƒÉ-mƒÉ c√¢nd se deschide votul');
}
function toggleFormNotify(){
  requestAndSetNotify('fnotify_'+MAG_ID,'formNotifyBtn','üîî Notificare forma»õii activatƒÉ ‚úì','üîî ActiveazƒÉ notificare forma»õii de start');
}

// Update button states on load
(function(){
  const vb=document.getElementById('voteNotifyBtn');
  if(vb&&localStorage.getItem('vnotify_'+MAG_ID)==='1'){vb.textContent='üîî Notificare activatƒÉ ‚úì';vb.classList.add('active');}
  const fb=document.getElementById('formNotifyBtn');
  if(fb&&localStorage.getItem('fnotify_'+MAG_ID)==='1'){fb.textContent='üîî Notificare forma»õii activatƒÉ ‚úì';fb.classList.add('active');}
})();

// Poll every 30s for vote/formation updates
setInterval(()=>{
  fetch(`/api/votes/${MAG_ID}`).then(r=>r.json()).then(d=>renderVotes(d.votes,d.voteStopped,d.mvp));
},30000);
</script>
</body>
</html>
